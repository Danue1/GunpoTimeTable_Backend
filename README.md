# GunpoTimeTable_Backend

êµ°í¬eë¹„ì¦ˆë‹ˆìŠ¤ê³ ë“±í•™êµ ì‹œê°„í‘œì˜ ë°±ì—”ë“œ ì„œë²„ë¥¼ ë‹´ë‹¹í•˜ëŠ” ì½”ë“œì…ë‹ˆë‹¤.

ë³¸ ë ˆí¬ì§€í† ë¦¬ëŠ” ì˜¤ì§ **ë°±ì—”ë“œ ë° API ì„œë²„ì˜ ê¸°ëŠ¥**ì„ ë‹´ë‹¹í•˜ë©°, ì‹œê°„í‘œë¥¼ íŒŒì‹±í•˜ì—¬ DBì— ì—…ë¡œë“œ í•˜ëŠ” ê¸°ëŠ¥ì€ [ì´ ë ˆí¬ì§€í† ë¦¬](https://github.com/notkimwol/GunpoTimeTable_Cron) ì—ì„œ ë‹´ë‹¹í•©ë‹ˆë‹¤.



## ê¸°ëŠ¥

- DBì— ì €ì¥ëœ ì‹œê°„í‘œ ì •ë³´ë¥¼ RESTful API í˜•ì‹ìœ¼ë¡œ ì œê³µ



## ê°œë°œ ìŠ¤íƒ

* í”„ë¡ íŠ¸ì—”ë“œ (WIP)
  * React
* ë°±ì—”ë“œ
  * DB : mongoDB (v4.2.1)
  * WEB : koaJS
* [ì„œë²„ íŒŒì‹±](https://github.com/notkimwol/GunpoTimeTable_Cron)
  * ì‹œê°„í‘œ ë°ì´í„° íŒŒì‹± : [comcigan-parser](https://github.com/leegeunhyeok/comcigan-parser)
  * ìë™í™” : node-cron
  * ë°ì´í„° ì „ì†¡ : request



## ì •ë³´

* Node ì„œë²„ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ 4001ë²ˆ í¬íŠ¸ì—ì„œ ì‘ë™í•©ë‹ˆë‹¤.
* .env.template íŒŒì¼ì„ ì°¸ê³ í•˜ì—¬ *.env íŒŒì¼ì„ ë§Œë“¤ì–´ì£¼ì„¸ìš”.



## í”„ë¡œì íŠ¸ êµ¬ì¡°

```text
â”‚  README.md
â”‚  .env // í”„ë¡œì íŠ¸ ì„¤ì • íŒŒì¼, gitì—ëŠ” ì—…ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.
â”‚  .env.template // í”„ë¡œì íŠ¸ ì„¤ì •íŒŒì¼ í…œí”Œë¦¿
â”‚  .gitignore
â”‚  package.json
â”‚  package-lock.json
â”‚  
â”œâ”€node_modules    
â”‚  
â””â”€src
   â”‚  timetableData.txt // dbì— ì €ì¥ë˜ëŠ” ì‹œê°„í‘œì˜ ì •ë³´ì…ë‹ˆë‹¤.
   â”‚  index.js
   â”‚  
   â”œâ”€db  // gitì— í¬í•¨ë˜ì–´ìˆì§€ ì•ŠìŠµë‹ˆë‹¤. ì§ì ‘ ë§Œë“¤ì–´ì£¼ì„¸ìš”.
   â”œâ”€api
   â”‚  â”‚  index.js // 1ì°¨ ë¼ìš°íŒ… (localhost/api)
   â”‚  â”‚  
   â”‚  â””â”€parse
   â”‚          index.js // 2ì°¨ ë¼ìš°íŒ… (localhost/api/parse)
   â”‚          parser.ctrl.js // 3ì°¨ ë¼ìš°íŒ… (localhost/api/parse/function)
   â”‚          
   â””â”€models
           timetable.js // ë°ì´í„° ëª¨ë¸ ë° api ìš”ì²­ ì²˜ë¦¬ ë¶€ë¶„
```



## ê¸°ì´ˆ ì„¤ì • ë° ì‚¬ìš©í•˜ê¸°

```bash
# ê¸°ë³¸ ì„¤ì •
npm install
# .env íŒŒì¼ ì¶”ê°€
touch .env

cd /src/
# ë°ì´í„°ë² ì´ìŠ¤ í´ë” ìƒì„±
mkdir db
```

```bash
# ì„œë²„ 1
# ë°±ì—”ë“œ ì„œë²„ ì‹¤í–‰
node src/index
```

```bash
# ì„œë²„ 2
# DB ì„œë²„ ì‹¤í–‰
# ë°˜ë“œì‹œ mongoDBê°€ ì„¤ì¹˜ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.
cd src
mongod --dbpath ./db
```



## ë¡œê·¸ ì‚´í´ë³´ê¸°

[name] : data í˜•ì‹ì˜ ë¡œê·¸ê°€ ì„œë²„ ì½˜ì†”ì— ì¶œë ¥ë  ë•Œ,

nameì€ í•´ë‹¹ ì„œë¹„ìŠ¤ì˜ ì´ë¦„ì„ ëœ»í•©ë‹ˆë‹¤.

dataëŠ” ê²°ê³¼ë¥¼ ëœ»í•©ë‹ˆë‹¤.



## API ë¬¸ì„œ

### (Create) https://localhost:4001/api/parse/insert/

#### ê¸°ëŠ¥

ë°ì´í„°ë² ì´ìŠ¤ì— ì‹œê°„í‘œì˜ ì •ë³´ì™€ ì‹œì •í‘œì˜ ì •ë³´ë¥¼ ì¶”ê°€í•˜ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.

* ì¤‘ìš” : ë³´ì•ˆì„ ìœ„í•´ ì˜¤ì§ **local ì—ì„œë§Œ** ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### API ìš”ì²­

NOTE : timeTableê³¼ classTimeì˜ ê°’ì„ ë°˜ë“œì‹œ JSON.stringify() ì²˜ë¦¬ í•´ì£¼ì„¸ìš”.

| Header       | Value                                                        |
| :----------- | :----------------------------------------------------------- |
| uri          | http://127.0.0.1:4001/api/parse/insert                       |
| method       | post                                                         |
| Content-Type | application/json                                             |
| json         | true                                                         |
| body         | {<br/>	"timeTable": String,<br/>    "classTime": String<br/>} |

#### API ì‘ë‹µ

* ì •ìƒì ì¸ ìš”ì²­ì˜ ê²½ìš°

| status | body    |
| ------ | ------- |
| 200    | success |

* ë¹„ì •ìƒì ì¸ ìš”ì²­ (valueì˜ Typeì´ ë§ì§€ ì•ŠìŒ)ì˜ ê²½ìš°

| status | body        |
| ------ | ----------- |
| 400    | Bad Request |

* ì„œë²„ì—ì„œ ì˜¤ë¥˜ê°€ ë‚˜ê²Œ ëœ ê²½ìš°

| status | body                  |
| ------ | --------------------- |
| 500    | Internal Server Error |



### (Read) http://localhost:4001/api/parse/getdata/

#### ê¸°ëŠ¥

ìµœê·¼ ë°ì´í„°ë² ì´ìŠ¤ì— ì¶”ê°€ëœ ì‹œê°„í‘œ ì •ë³´ë¥¼ ë°›ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.

#### API ìš”ì²­

| Header       | Value                                  |
| :----------- | :------------------------------------- |
| uri          | http://localhost:4001/api/parse/getdata/ |
| method | get |
| body | {} |

#### API ì‘ë‹µ

* ì •ìƒì ì¸ ìš”ì²­ì˜ ê²½ìš°

NOTE : timeTableê³¼ classTimeì˜ ê°’ì„ ë°˜ë“œì‹œ JSON.parse() ì²˜ë¦¬ í•´ì£¼ì„¸ìš”.

| status | body                                                         |
| ------ | ------------------------------------------------------------ |
| 200    | {<br/>      "checkSum" : String,<br/>      "_id" : String,<br/>      "data": {<br/>          "timeTable" : String,<br/>          "classTime" : String,<br/>          "unixTime" : Number<br/>      }<br/> } |

* ì„œë²„ì—ì„œ ì˜¤ë¥˜ê°€ ë‚˜ê²Œ ëœ ê²½ìš°

| status | body                  |
| ------ | --------------------- |
| 500    | Internal Server Error |



### (Read) http://localhost:4001/api/parse/getidx/

#### ê¸°ëŠ¥

ìµœê·¼ ë°ì´í„°ë² ì´ìŠ¤ì— ì¶”ê°€ëœ ì‹œê°„í‘œ ì˜ idê°’ì„ ë°›ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.

#### API ìš”ì²­

| Header       | Value                                  |
| :----------- | :------------------------------------- |
| uri          | http://localhost:4001/api/parse/getidx/ |
| method | get |
| body | {} |

#### API ì‘ë‹µ

* ì •ìƒì ì¸ ìš”ì²­ì˜ ê²½ìš°

| status | body                              |
| ------ | --------------------------------- |
| 200    | {<br/>      "_id" : String,<br/>} |

* ì„œë²„ì—ì„œ ì˜¤ë¥˜ê°€ ë‚˜ê²Œ ëœ ê²½ìš°

| status | body                  |
| ------ | --------------------- |
| 500    | Internal Server Error |



## ì»¤ë°‹ ì´ëª¨ì§€ ì‚´í´ë³´ê¸°

ì£¼ì˜ : 0.0.5 ë¦´ë¦¬ì¦ˆ ì´ì „ì—ëŠ” ì˜ëª» ê¸°ë¡ëœ ì»¤ë°‹ ì´ëª¨ì§€ê°€ ìˆì„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì–‘í•´ ë¶€íƒ ë“œë¦½ë‹ˆë‹¤!

| emoji | description                                  |
| ----- | -------------------------------------------- |
| âœ¨     | ê¸°ëŠ¥ ë˜ëŠ” íŒŒì¼ì´ ì¶”ê°€ë˜ëŠ” ê²½ìš°               |
| ğŸ”¨     | ì½”ë“œë¥¼ ìˆ˜ì •í•œ ê²½ìš°                           |
| ğŸ¤”     | ì½”ë“œë¥¼ ì •ë¦¬í•˜ëŠ” ë“±ì˜ ìì˜í•œ ìˆ˜ì •ì´ ìˆëŠ” ê²½ìš° |
| ğŸ—‘     | ê¸°ëŠ¥ ë˜ëŠ” íŒŒì¼ì´ ì œê±°ë˜ëŠ” ê²½ìš°               |
| ğŸ‰     | ë¸Œëœì¹˜ë¥¼ ë¨¸ì§€í•˜ëŠ” ê²½ìš°                       |
| ğŸ›     | ë²„ê·¸ë¥¼ ìˆ˜ì •í•˜ëŠ” ê²½ìš°                         |
| ğŸ‘Œ     | TODO ì•„ì´í…œì„ ì™„ë£Œí•œ ê²½ìš°                    |